# This Dockerfile allows us to install and use the gh-cli tool to support CI/CD ops using Github API's
# See https://cli.github.com/manual/
# To manually build this image, use docker build --name gh-cli:latest --quiet .
FROM ubuntu:20.04
RUN apt-get update && apt-get install -y \
  curl \
  gpg
RUN curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | gpg --dearmor -o /usr/share/keyrings/githubcli-archive-keyring.gpg;
RUN echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main" | tee /etc/apt/sources.list.d/github-cli.list > /dev/null;
RUN apt-get update && apt-get install -y gh;
# These copied files hold our github personal access token which allows us to use the Github API's
# and the name of the branch on Github that we want to create a PR for.
# The name of the branch was autogenerated in the script 'push-temp-branch-ghub.sh'
# We need these to copy these two files into the image so that we can execute the scripts in 'generate-develop-pr.sh'
COPY ghtoken.txt ghtoken.txt
COPY tempbranch.txt tempbranch.txt
#
CMD [ "/bin/bash" ]
